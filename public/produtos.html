<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Produtos</title>
    <link rel="stylesheet" href="css/produtosStyle.css">
    <script src="js/produtos.js" defer></script>
</head>

<body>
    <header>
        <!-- HEADER -->
        <div class="header-main">
            <div class="container-menu">
                <div class="logo-menu">
                    <div class="logo">
                        <a href="index.html">
                            <div class="txt-logo">
                                <b id="iLogo">i</b>Song
                            </div>
                        </a>
                    </div>
                    <div class="menu">
                        <ul>
                            <li id="home"><em><a href="index.html">HOME</a></em></li>
                            <li id="sobre"><em><a href="sobre.html">SOBRE A MÚSICA</a></em></li>
                            <li id="atual"><em><a href="produtos.html">PRODUTOS</a></em></li>
                        </ul>
                    </div>
                </div>
                <div class="cadLog">
                    <div class="btn-cadastro-login">
                        <a onclick="verificar()" id="btn-entrar" href="#">ENTRE</a>
                        <p id="ou">ou</p>
                        <a id="btn-cadastro" href="cadastro.html">CADASTRE-SE</a>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div class="pagina-produtos">
        <div class="container-filtros">

        </div>
        <div class="container-produtos">
            <div class="template">

                <div class="dropdown-content">
                    <div class="preco">Preço: R$ 100.00</div>
                    <div class="botao-compra"><a onclick="comprar(1)">COMPRAR</a></div>
                </div>

                <div class="produto" >
                    <img src="assets/products/combo-utils.png" alt="">
                </div>

                <div class="desc">
                    <p id="combo-utils"></p>
                </div>
            </div>
            <div class="template" >
                <div class="dropdown-content">
                    <div class="preco">Preço: R$ 350.00</div>
                    <div class="botao-compra"><a onclick="comprar(2)">COMPRAR</a></div>
                </div>
                <div class="produto">
                    <img src="assets/products/amp-cubo-vorax.png" alt="">
                </div>
                
                
                <div class="desc">
                    <p id="amplificador"></p>
                </div>
            </div>
            <div class="template" >
                <div class="dropdown-content">
                    <div class="preco">Preço: R$ 15.00</div>
                    <div class="botao-compra"><a onclick="comprar(3)">COMPRAR</a></div>
                </div>
                <div class="produto">
                    <img src="assets/products/combo-palhetas-celuloid.png" alt="">
                </div>
                
                
                <div class="desc">
                    <p id="combo-palhetas"></p>
                </div>
            </div>
            <div class="template" >
                <div class="dropdown-content">
                    <div class="preco">Preço: R$ 40.00</div>
                    <div class="botao-compra"><a onclick="comprar(4)">COMPRAR</a></div>
                </div>
                <div class="produto">
                    <img src="assets/products/cordas-daddario.jpg" alt="">
                </div>
                
                
                <div class="desc">
                    <p id="cordas-daddario"></p>
                </div>
            </div>
            <div class="template">
                <div class="dropdown-content">
                    <div class="preco">Preço: R$ 120.00</div>
                    <div class="botao-compra"><a onclick="comprar(5)">COMPRAR</a></div>
                </div>
                <div class="produto">
                    <img src="assets/products/elixir-violao.png" alt="">
                </div>
                
                
                <div class="desc">
                    <p id="cordas-elixir"></p>
                </div>
            </div>
            <div class="template" >
                <div class="dropdown-content">
                    <div class="preco">Preço: R$ 550.00</div>
                    <div class="botao-compra"><a onclick="comprar(6)">COMPRAR</a></div>
                </div>
                <div class="produto">
                    <img src="assets/products/giannini-n14.png" alt="">
                </div>
                
                
                <div class="desc">
                    <p id="combo-violao"></p>
                </div>
            </div>
            <div class="template" >
                <div class="dropdown-content">
                    <div class="preco">Preço: R$ 150.00</div>
                    <div class="botao-compra"><a onclick="comprar(7)">COMPRAR</a></div>
                </div>
                <div class="produto">
                    <img src="assets/products/suporte-violao-removebg-preview.png" alt="">
                </div>
                
                
                <div class="desc">
                    <p id="suporte-parede"></p>
                </div>
            </div>
            <div class="template" >
                <div class="dropdown-content">
                    <div class="preco">Preço: R$ 3.00</div>
                    <div class="botao-compra"><a onclick="comprar(8)">COMPRAR</a></div>
                </div>
                <div class="produto">
                    <img src="assets/products/palheta-dunlop.png" alt="">
                </div>
                
                
                <div class="desc">
                    <p id="palheta-flow"></p>
                </div>
            </div>
            <div class="template" >
                <div class="dropdown-content">
                    <div class="preco">Preço: R$ 720.00</div>
                    <div class="botao-compra"><a onclick="comprar(9)">COMPRAR</a></div>
                </div>
                <div class="produto">
                    <img src="assets/products/pedal-fender.png" alt="">
                </div>
                
                
                <div class="desc">
                    <p id="pedal-fender"></p>
                </div>
            </div>
            <div class="template" >
                <div class="dropdown-content">
                    <div class="preco">Preço: R$ 170.00</div>
                    <div class="botao-compra"><a onclick="comprar(10)">COMPRAR</a></div>
                </div>
                <div class="produto">
                    <img src="assets/products/suporte-dobravel.png" alt="">
                </div>
                
                
                <div class="desc">
                    <p id="suporte-chao"></p>
                </div>
            </div>
        </div>
    </div>

</body>

</html>

<script>

    function comprar(stringIdProduto) {

        let idProduto = Number(stringIdProduto);
        let idUsuario = Number(sessionStorage.ID_USUARIO);

        alert('Parabéns pela compra!');

        cadastrarVenda(idProduto, idUsuario);
        cadastrarPontos(20, idUsuario);

        // setTimeout(() => {
        //     window.location = 'index.html';
        // }, 10000);

    }

    function cadastrarVenda(idProduto, idUsuario) {

        console.log("CHEGANDO AQUI");
        
        fetch("/usuarios/cadastrarProduto", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                // crie um atributo que recebe o valor recuperado aqui
                // Agora vá para o arquivo routes/usuario.js
                idProdutoServer: idProduto,
                idUsuarioServer: idUsuario
            })
        }).then(function (resposta) {

            console.log("resposta: ", resposta);

            if (resposta.ok) {
                throw('belezinha')
            } else {
                throw ("Houve um erro ao tentar realizar o cadastro!");
            }
        }).catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);
            // finalizarAguardar();
        });

        return false;
    }

    function cadastrarPontos(pontos, idUsuario) {

        console.log("CHEGANDO AQUI");

        fetch("/usuarios/cadastrarPontos", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                // crie um atributo que recebe o valor recuperado aqui
                // Agora vá para o arquivo routes/usuario.js
                pontosServer: pontos,
                idUsuarioServer: idUsuario
            })
        }).then(function (resposta) {

            console.log("resposta: ", resposta);

            if (resposta.ok) {
                throw('belezinha')
            } else {
                throw ("Houve um erro ao tentar realizar o cadastro da pontuação!");
            }
        }).catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);
            // finalizarAguardar();
        });

        return false;
        }

</script>